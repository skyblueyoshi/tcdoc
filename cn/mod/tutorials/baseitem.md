# 创建基本的物品

在这一章中，您将了解**数据表**的概念，并试着学习编写一些简单的数据表。

在整个Mod开发流程中填写相关数据通常采用编写数据表的形式进行，而逻辑处理则采用编写Lua脚本语言进行。而仅仅进行数据表填写操作，也可以完成大部分Mod的功能。

您可以通过本章学会编写这些数据表：_物品数据表、物品组数据表、翻译数据表_。

## 0、数据表（DataTable）

Mod对于所有对象均采用**JSON数据表**的形式进行初始化。数据表内部所有的名称使用空间均为Mod所在的私有空间，而不是使用全局空间。如果想要进行Mod之间的联动，需要指向其他Mod的对象，请使用`其他Mod的命名空间:名称`。举个例子：

> 假设当前加载了命名空间为happy\_days和coco\_world的两个模组，happy\_days模组有一个叫做cat\_bullet的物品，coco\_world模组希望与happy\_days模组进行联动，设计了一把枪械叫做dog\_gun，希望用happy\_days的cat\_bullet作为弹药。  
> 那么在coco\_world数据表的dog\_gun中写入的弹药物品应为happy\_days:cat\_bullet。如果直接写cat\_bullet只会在原版物品和当前模组物品中查找这个名称，找不到就直接报错。

如果Mod私有空间中的对象名称跟TerraCraft原版名称相同，则实际指向Mod的这个对象，而不是TerraCraft原版的对象。如果想指向TerraCraft原版的对象，请使用`tc:名称`。还是举个例子：

> 假设当前希望编写一个模组，将9个原版泥土合成1个钻石，而当前模组已经出现了命名为dirt的物品。如果直接使用dirt，那么会采用模组的dirt来合成钻石。而如果使用tc:dirt，则会采用原版的泥土合成钻石。

### TerraCraftForge的数据表注册机制

在编写第一个数据表之前，您需要简单地了解一下数据表是干什么用的。TCF在加载所有模组时会自动对数据表的每个对象进行**注册（Register）**，之后每个对象会得到游戏内动态生成的唯一数字ID，这个数字ID在整个游戏运行时是不会发生改变的。_这个知识点在Lua脚本教程中会用到哦0w0。_

### 数据表编写

如果你想要编写一个数据表，我们建议在`/mods/terracraft`中寻找相对于的数据表，并仿照这个数据表的格式进行编写。

同时您应该按照严格格式的数据表规范进行编写，参阅[模组数据表文档](../datatable.md)。注意，数据表严格采用JSON格式填写，并且并不支持注释。

## 1、物品数据表

在Mod项目文件夹中创建`items/items.json`文件作为物品数据表。编写物品数据可以参考`mods/terracraft/items/items.json`这个自带的数据表。

物品数据表准循如下基本的JSON格式：

```text
[
  {
    "名称1": {
      "属性1": "值",
      "属性2": "值",
      ...
    }
  },
  {
    "名称2": {
      "属性1": "值",
      "属性2": "值",
      ...
    }
  },
  ...
]
```

## 2、开始创建物品

在游戏中，我们把物品分为这么几大类：_**材料类（Materials）、方块类（Blocks）、工具类（Tools）、抛射物类（Projectiles）、存储类（Chests）**。_

这几类物品的使用场合如下：

| 类型 | 常量名称 | 最大堆叠数 | 描述 | 常见 |
| :--- | :--- | :--- | :--- | :--- |
| 材料类 | MATERIALS | 640 | 最常见、最通用、最简单的物品，一般不附带特殊数据 | 原料、食物、药水等 |
| 方块类 | BLOCKS | 640 | 用于放置方块 | 地砖、家具等 |
| 工具类 | TOOLS | 1 | 有附魔、耐久度等属性 | 装备、武器、镐子、斧头等 |
| 抛射物类 | PROJECTILES | 1000 | 可以大量抛掷出去，或者作为某种武器的消耗品 | 炸弹、箭、子弹等 |
| 存储类 | CHESTS | 1 | 可以存储多种物品 | 潜影盒 |

## 2.1 创建一个材料类物品

我们从最简单的材料类物品开始创建！

![&#x8FD9;&#x662F;&#x4E00;&#x679A;IC2&#x7684;&#x786C;&#x5E01;&#xFF01;](../../../.gitbook/assets/coin.png)

假设我们想要添加图中的物品（具体物品想怎么用你说的算0w0，比如玩家之间货币交换之类的），我们先将这个物品图标放在Mod工程目录下的`/textures/items/icon/materials`内，命名为`coin.png`。当然不一定要按这个目录放，只要你在数据表填写贴图路径时与textures文件夹的绝对路径能够对应上就行。

在`items/items.json`数据表中写入如下信息：

```text
[
   {
      "coin": {
        "type": "MATERIALS",
        "iconTextureData": "item\\icon\\material\\coin.png",
        "group": "GROUP_MATERIAL"
      }
   }
]
```

> type属性表示当前物品类型，使用物品类型表中的常量名称字符串作为值。  
> iconTextureData属性表示当前物品图标在模组textures文件夹的相对位置。  
> group表示物品所在分组。

保存这个JSON数据表文件，然后运行TerraCraft。打开物品界面，你会看到这个新的货币已经加入到了游戏中！但是，玩家看到的物品名称却是`命名空间:名称`（如`my_first_mod:coin`），这是因为我们还没有将物品的文字信息加入到翻译文件中。我们的征途是让Mod走向国际化，因此我们不仅需要写中文的翻译文件，也需要写英文翻译文件。

### Mod翻译替换规则

我们一般建议**必须进行英文翻译**，即必须填写英文语言文件的数据表，而其他语言根据自己的掌握情况尽可能填写。因为我们切换语言的时候总是基于如下规则进行展示文本替换的：

> 如果目标语言展示文本不存在，使用英文展示文本。  
> 如果英文展示文本不存在，使用`命名空间:名称`。  
> 如果不适合使用上述文本，则使用`空`。

### 写入物品的翻译文本

每次创建一个新的物品，我们还需要把物品的文本信息写入到翻译数据表内。创建`/languages/english.json`和`/languages/chinese.json`两个文件作为英文和中文的翻译数据表。

对于`/languages/english.json`英文翻译数据表，写入如下信息：

```text
{
  "items": [
    [ "coin", "Coin", "This is a coin." ]
  ]
}
```

对于`/languages/chinese.json`中文翻译数据表，写入如下信息：

```text
{
  "items": [
    [ "coin", "硬币", "这是一枚硬币。" ]
  ]
}
```

对于JSON中items数组的每一项，第一个字符串表示物品在**Mod私有空间中的名称**，第二个字符串表示**对玩家展示的名称**，第三个字符串是对于该物品的**描述**。

保存JSON翻译数据表文件（记得保存为UTF8无签名的格式），并运行TerraCraft。物品名称已经可以正常显示，并且可以根据自己选择的不同语言切换到对应的展示文本。

## 2.2 创建食物/有效果的食物/药水

我们想要创建一些可以食用的物品，比如下面这个物品（图源自IC2的锡罐头）：

![filled\_tin\_can.png](../../../.gitbook/assets/filled_tin_can.png)

我们希望食用了这个锡罐头后，能够增加生命和魔法，但是会造成虚弱和短暂的隐身效果。我们为物品数据表中写入如下信息：

```text
"filled_tin_can": {
    "type": "MATERIALS",
    "iconTextureData": "item\\icon\\material\\filled_tin_can.png",
    "group": "GROUP_FOOD",
    "eatable": true,
    "addHealth": 20,
    "addMagic": 50,
    "buffs": [
      {
        "id": "weak",
        "time": 3600
      },
      {
        "id": "invisibility",
        "time": 60
      },
    ]
}
```

> eatable属性表示物品可以被鼠标按下左键“食用”  
> addHealth属性表示食用后玩家增加的生命值，负数表示减少  
> addMagic属性表示食用后玩家增加的魔法值，负数表示减少  
> buffs属性表表示食用后玩家产生的状态效果以及对应的时间（以帧为单位，1秒为60帧）。

如果我们希望实现MC的喝药水模式（喝完还空瓶子），而不是TR的喝药水模式（喝完把玻璃瓶也吃了）。我们可以设定吃完当前物品后归还什么物品。假设我们加入了下面的物品：

![&#x7A7A;&#x9521;&#x7F50;&#xFF08;empty\_tin\_can&#xFF09;](../../../.gitbook/assets/tin_can.png)

为`filled_tin_can`继续添加如下属性：

```text
"eatReturnId": "empty_tin_can"
```

这样吃完锡罐后会在玩家背包内归还空锡罐！您可以通过这类特性实现MC或者TR的相关药水饮用效果。

